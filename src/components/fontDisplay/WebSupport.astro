---
import { Code } from 'astro/components';
import { getFontReporter } from '../../utils/getFontReporter';
import { ensureFontMessageString } from '../../utils/ensureFontMessageString';
import { AllCDN } from '../../global';
import type { NameTable } from '@konghayao/cn-font-split/dist/templates/reporter';

export type Props = {
    font: string;
    name: string;
};
const { font, name: font_name } = Astro.props;
const fileName = font_name!
    .replaceAll(' ', '_')
    // æ›´æ¢æ–‡ä»¶å¤¹ä¸­çš„ . ä¸º _
    .replace(/(?<=\/.*)\.(?=.*\/)/g, '_');
const reporter = await getFontReporter(font!, fileName);
const CDNs = AllCDN.map((i) => i + `/packages/${font}/dist/${font_name}`);
const theme = 'github-light' as const;
const message = reporter.message.windows as NameTable ?? reporter.message
---

<header class="my-4 text-lg">
    <span class="bg-orange-600 text-white p-2 rounded-lg"> ğŸŒ æŠ€æœ¯æ”¯æŒ</span>
</header>
<div class="bg-white flex flex-col p-4 rounded-2xl">
    <h3>
        ğŸ“¦æ‰‹åŠ¨åœ¨çº¿åˆ†åŒ…
        <a href="/online-split" class="float-right text-orange-600">åœ¨çº¿åˆ†åŒ…é¡µé¢</a>
    </h3>

    <ol class="list-decimal px-8 text-xs py-4">
        <li>è¿›å…¥<a href="/online-split">åœ¨çº¿åˆ†åŒ…é¡µé¢</a>ï¼Œä¸Šä¼ å­—ä½“ï¼Œå¹¶ç‚¹å‡»åˆ†åŒ…</li>
        <li>åˆ†åŒ…å®Œæˆåï¼Œä¸‹è½½ zip æ–‡ä»¶åŒ…</li>
        <li>è§£å‹ï¼Œå°†æ•´ä¸ªæ–‡ä»¶å¤¹è¿åŒæ‰€æœ‰æ–‡ä»¶ä¸Šä¼ è‡³æ‚¨çš„ CDN å³å¯ï¼</li>
    </ol>
    <div class="text-red-600">
        <a href="/post/deploy_to_cdn"> ğŸ“–è¯¦ç»†æ•™ç¨‹: æ•™ä½ è‡ªè¡Œéƒ¨ç½²å­—ä½“</a>
    </div>
</div>
<div class="bg-white flex flex-col p-4 rounded-2xl">
    <h3>
        ğŸ”— é€šè¿‡é“¾æ¥åµŒå…¥
        <select
            id="cdn-select"
            class="float-right m-0 flex-1 bg-green-600 text-white rounded-md p-1 outline-none text-xs"
            value={new URL(CDNs[0]).host}
        >
            {
                CDNs.map((item) => (
                    <option class="text-xs" value={item}>
                        {new URL(item).host}
                    </option>
                ))
            }
        </select>
    </h3>
    <blockquote class="text-xs py-4">
        ğŸ””é“¾æ¥æ–¹å¼å¯ä»¥è¢«ç½‘é¡µã€å°ç¨‹åºç­‰æ”¯æŒç±» CSS æ ·å¼è½½å…¥çš„å¹³å°ä½¿ç”¨ã€‚
    </blockquote>

    <span class="select-text my-2 p-2 text-sm border border-neutral-200 rounded-md">
        <Code
            wrap
            lang="html"
            theme={theme}
            code={`<link rel='stylesheet' href='${CDNs[0]}/result.css' /> `}
        />
    </span>
    <span class="select-text my-2 p-2 text-sm border border-neutral-200 rounded-md">
        <Code wrap lang="css" theme={theme} code={`@import("${CDNs[0]}/result.css") `} />
    </span>
    <blockquote class="text-xs py-4 text-rose-600">
        ğŸ”’ å…¬å…± CDNæ¯æœˆåªæä¾›æœ‰é™æµé‡çš„å­—ä½“æœåŠ¡ï¼Œä¸ä¿è¯ç¨³å®šæ€§ï¼Œå»ºè®®è‡ªè¡Œéƒ¨ç½²ã€‚
        <br />
        âºï¸ ä½¿ç”¨å­—ä½“å‰è¯·éµå®ˆç›¸å…³æˆæƒä¿¡æ¯ï¼Œä½¿ç”¨å­—ä½“çš„é¡¹ç›®å¿…é¡»æ ‡æ³¨å­—ä½“åç§°ã€æ¥æºä¿¡æ¯ï¼
        <br />
        <a href="/font-list.json">ğŸ¥ª æä¾›æ‰€æœ‰å­—ä½“CSSçš„æ¥å£åœ¨è¿™é‡Œ</a>
    </blockquote>
</div>

<div class="bg-white p-4 select-text rounded-2xl">
    <h3>ğŸ””é™å®šå­—ä½“ä½¿ç”¨åŒºåŸŸ</h3>
    <Code
        wrap
        lang="css"
        theme={theme}
        code={`article {\n    font-family:'${ensureFontMessageString(
            message.fontFamily
        )}';\n    font-weight:'${
            ensureFontMessageString(message.fontSubFamily) ?? '400'
        }'\n};`}
    />
</div>
<a
    href="/post/simple_tutorial"
    class="bg-green-600 text-white flex cursor-pointer justify-center items-center"
>
    <div>
        è¯¦æƒ…è¯·æŸ¥çœ‹ <br />ğŸ“–ä½¿ç”¨æŒ‡å—
    </div>
</a>
