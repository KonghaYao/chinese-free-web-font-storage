---
import data from '../../../index.json';
import { Code } from 'astro/components';
import { getFontReporter } from '../../utils/getFontReporter';

export type Props = {
    font: string;
    name: string;
};
const { font, name: font_name } = Astro.props;
const fileName = font_name!
    .replaceAll(' ', '_')
    // æ›´æ¢æ–‡ä»¶å¤¹ä¸­çš„ . ä¸º _
    .replace(/(?<=\/.*)\.(?=.*\/)/g, '_');
const reporter = await getFontReporter(font!, fileName);
const CDNs = [`https://ik.imagekit.io/chinesefonts/packages/${font}/dist/${font_name}/result.css`];
const theme = 'github-light' as const;
---

<header class="my-4 text-lg">
    <span class="bg-orange-600 text-white p-2 rounded-lg"> ğŸŒ ä»£ç æ”¯æŒ</span>
</header>
<div class="bg-white flex flex-col p-4 rounded-2xl">
    <h3>
        ğŸ”— é€šè¿‡é“¾æ¥åµŒå…¥
        <select
            id="cdn-select"
            class="float-right m-0 flex-1 bg-green-600 text-white rounded-md p-1 outline-none text-xs"
            value={new URL(CDNs[0]).host}
        >
            {
                CDNs.map((item) => (
                    <option class="text-xs" value={item}>
                        {new URL(item).host}
                    </option>
                ))
            }
        </select>
    </h3>

    <blockquote class="text-xs py-4">
        ğŸ””é“¾æ¥æ–¹å¼å¯ä»¥è¢«ç½‘é¡µã€å°ç¨‹åºç­‰æ”¯æŒç±» CSS æ ·å¼è½½å…¥çš„å¹³å°ä½¿ç”¨ã€‚
    </blockquote>

    <script>
        document.getElementById('cdn-select')!.onchange = (e) => {
            const url = (e.target as HTMLInputElement).value;
            document
                .getElementById('link-code')!
                .querySelector('.line span:nth-child(10)')!.textContent = `'${url}'`;
        };
    </script>
    <span id="link-code" class="select-text">
        <Code
            wrap
            lang="html"
            theme={theme}
            code={`<link rel='stylesheet' href='${CDNs[0]}' /> `}
        />
    </span>
</div>
<div class="flex flex-1 flex-col gap-1 sm:gap-4 bg-white p-4 select-text rounded-2xl">
    <h3>
        âŒ¨ï¸ å‰ç«¯ä»£ç åµŒå…¥

        <aside class="float-right bg-rose-600 text-white text-sm p-1 rounded-md">
            <a href={`https://npmjs.com/@chinese-fonts/${font}`}>NPM</a>
        </aside>
    </h3>
    <blockquote class="text-xs py-2">ğŸ”” å‰ç«¯ä»£ç éœ€è¦é…åˆ Vite æˆ–è€… Webpack æ‰“åŒ…å™¨ä½¿ç”¨</blockquote>
    <Code wrap lang="sh" theme={theme} code={`npm install @chinese-fonts/${font}`} />

    <Code
        wrap
        lang="js"
        theme={theme}
        code={`import "@chinese-fonts/${font}/dist/${font_name}/result.css";`}
    />
</div>
<div class="bg-white p-4 select-text rounded-2xl">
    <h3>ğŸ””é™å®šå­—ä½“ä½¿ç”¨åŒºåŸŸ</h3>
    <Code
        wrap
        lang="css"
        theme={theme}
        code={`article {\n    font-family:'${reporter.message.fontFamily}';\n    font-weight:'${reporter.message.fontSubFamily}'\n};`}
    />
</div>
<a
    href="/post/simple_tutorial"
    class="bg-green-600 text-white flex cursor-pointer justify-center items-center"
>
    <div>
        è¯¦æƒ…è¯·æŸ¥çœ‹ <br />ğŸ“–ä½¿ç”¨æŒ‡å—
    </div>
</a>
